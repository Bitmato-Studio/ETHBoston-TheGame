<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stock Portfolio App</title>
    <!-- Add Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KyZXEAg3QhqLMpG8r+Knujsl7/1L_dstPt3HV5HzF6Gvk/e3R+s9QF2C+igN75pt" crossorigin="anonymous">
    <!-- Add Google Font -->
    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,700&display=swap" rel="stylesheet">
    <!-- Add Custom CSS -->
    <link rel="stylesheet" href="/static/css/styles.css">
    <!-- Add Bootstrap JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js" integrity="sha384-cn7l7gDp0eyniUwwAZgrzD06kc/tftFf19TOAs2zVinnD/C7E91j9yyk5//jjpt/" crossorigin="anonymous"></script>
</head>

<body>

    <!-- Add JavaScript to refresh the page on any click action 
    <script>
        document.addEventListener('click', function() {
            location.reload();
        });
    </script> -->

    <h1 class="mb-4">Stock Portfolio App</h1>

    <div class="section">
        <h2>Company Prices</h2>
        <table class="table">
            <thead>
                <tr>
                    <th>Company</th>
                    <th>Price</th>
                    <th>Total Shares</th>
                    <th>Total Market Cap</th>
                </tr>
            </thead>
            <tbody>
                {% for company in companies %}
                    <tr>
                        <td>{{ company.name }}</td>
                        <td>{{ company.value }}</td>
                        <td>{{ company.total_shares }}</td>
                        <td>{{ company.value * company.total_shares }}</td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <!-- Add trade form -->
    <div class="section">
        <h2>Trade Shares</h2>
        <form method="POST" action="/trade">
            <div class="form-group">
                <label for="company">Company</label>
                <select class="form-control" id="company" name="company">
                    {% for company in companies %}
                        <option value="{{ company.name }}">{{ company.name }}</option>
                    {% endfor %}
                </select>
            </div>
            <div class="form-group">
                <label for="shares">Number of shares</label>
                <input type="number" class="form-control" id="shares" name="shares" min="1">
            </div>
            <div class="form-group">
                <label for="action">Action</label>
                <select class="form-control" id="action" name="action">
                    <option value="Buy">Buy</option>
                    <option value="Sell">Sell</option>
                </select>
            </div>
            <button type="submit" class="btn btn-primary">Submit</button>
        </form>
    </div>

    <!-- Update user portfolio -->
    <div class="section">
        <h2>User Portfolio</h2>
        <table class="table">
            <thead>
                <tr>
                    <th>Company</th>
                    <th>Shares</th>
                    <th>Total Value</th>
                </tr>
            </thead>
            <tbody>
                {% for holding in holdings_with_value %}
                    <tr>
                        <td>{{ holding[0] }}</td>
                        <td>{{ holding[1] }}</td>
                        <td>{{ holding[2] }}</td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>


    <div class="section">
        <h2>Vote for Companies</h2>
        {% for company in companies %}
            <form method="POST" action="/vote">
                <div class="mb-3">
                    <input type="hidden" name="company" value="{{ company.name }}">
                    <label class="form-label">{{ company.name }} (Votes: {{ company.clicks }})</label>
                    <input type="submit" class="btn btn-primary" value="Vote">
                </div>
            </form>
        {% endfor %}
    </div>

</body>


</html>
